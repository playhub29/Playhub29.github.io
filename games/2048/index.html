<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2048 | PlayHub</title>

<style>
  body {
    margin: 0;
    background: #0b1020;
    color: white;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }

  header {
    width: 100%;
    padding: 15px;
    background: #111827;
    display: flex;
    justify-content: space-between;
    box-sizing: border-box;
  }

  header a {
    color: white;
    text-decoration: none;
    background: #2563eb;
    padding: 8px 12px;
    border-radius: 6px;
  }

  .board {
    width: 320px;
    height: 320px;
    background: #1e293b;
    border-radius: 12px;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
    gap: 10px;
    padding: 10px;
    margin-top: 20px;
    box-sizing: border-box;
  }

  .cell {
    background: #020617;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    font-weight: bold;
  }

  .n2 { background: #eee4da; color: #111; }
  .n4 { background: #ede0c8; color: #111; }
  .n8 { background: #f2b179; }
  .n16 { background: #f59563; }
  .n32 { background: #f67c5f; }
  .n64 { background: #f65e3b; }
  .n128 { background: #edcf72; color:#111; }
  .n256 { background: #edcc61; color:#111; }
  .n512 { background: #edc850; color:#111; }
  .n1024 { background: #edc53f; }
  .n2048 { background: #edc22e; }

</style>
</head>
<body>

<header>
  <h3>2048</h3>
  <a href="/">üè† Home</a>
</header>

<div class="board" id="board"></div>

<script>
  const board = document.getElementById("board");
  let grid = [];

  function start() {
    grid = Array(16).fill(0);
    addTile();
    addTile();
    draw();
  }

  function addTile() {
    let empty = grid
      .map((v, i) => v === 0 ? i : null)
      .filter(v => v !== null);
    if (!empty.length) return;
    let i = empty[Math.floor(Math.random() * empty.length)];
    grid[i] = Math.random() < 0.9 ? 2 : 4;
  }

  function draw() {
    board.innerHTML = "";
    grid.forEach(v => {
      const cell = document.createElement("div");
      cell.className = "cell" + (v ? " n" + v : "");
      cell.textContent = v || "";
      board.appendChild(cell);
    });
  }

  function slide(row) {
    row = row.filter(v => v);
    for (let i = 0; i < row.length - 1; i++) {
      if (row[i] === row[i + 1]) {
        row[i] *= 2;
        row[i + 1] = 0;
      }
    }
    return row.filter(v => v).concat(Array(4).fill(0)).slice(0,4);
  }

  function rotate(times) {
    for (; times > 0; times--) {
      grid = grid.map((_, i) =>
        grid[12 + (i % 4) - 4 * Math.floor(i / 4)]
      );
    }
  }

  function move(dir) {
    let old = grid.join();
    rotate(dir);
    for (let r = 0; r < 4; r++) {
      let row = grid.slice(r * 4, r * 4 + 4);
      row = slide(row);
      grid.splice(r * 4, 4, ...row);
    }
    rotate((4 - dir) % 4);
    if (grid.join() !== old) {
      addTile();
      draw();
    }
  }

  document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") move(0);
    if (e.key === "ArrowUp") move(1);
    if (e.key === "ArrowRight") move(2);
    if (e.key === "ArrowDown") move(3);
  });

  start();
</script>

</body>
</html>
