<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2048 | PlayHub</title>

<style>
  body {
    margin: 0;
    background: #0b1020;
    font-family: Arial, sans-serif;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }

  header {
    width: 100%;
    padding: 15px;
    background: #111827;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-sizing: border-box;
  }

  header a, header button {
    background: #2563eb;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 6px;
    text-decoration: none;
    cursor: pointer;
  }

  .stats {
    margin: 10px 0;
    display: flex;
    gap: 20px;
    font-size: 14px;
  }

  .board {
    width: 320px;
    height: 320px;
    background: #1e293b;
    border-radius: 12px;
    padding: 10px;
    box-sizing: border-box;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
    gap: 10px;
    touch-action: none;
  }

  .cell {
    background: #020617;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 28px;
  }

  .n2 { background:#eee4da; color:#111 }
  .n4 { background:#ede0c8; color:#111 }
  .n8 { background:#f2b179 }
  .n16 { background:#f59563 }
  .n32 { background:#f67c5f }
  .n64 { background:#f65e3b }
  .n128 { background:#edcf72; color:#111; font-size:22px }
  .n256 { background:#edcc61; color:#111; font-size:22px }
  .n512 { background:#edc850; color:#111; font-size:22px }
  .n1024 { background:#edc53f; font-size:18px }
  .n2048 { background:#edc22e; font-size:18px }

</style>
</head>
<body>

<header>
  <a href="/">üè† Home</a>
  <button onclick="resetGame()">üîÑ Restart</button>
</header>

<div class="stats">
  <div>Score: <span id="score">0</span></div>
  <div>High: <span id="high">0</span></div>
</div>

<div class="board" id="board"></div>

<script>
const board = document.getElementById("board");
const scoreEl = document.getElementById("score");
const highEl = document.getElementById("high");

let grid, score = 0;
let high = localStorage.getItem("2048high") || 0;
highEl.textContent = high;

function resetGame() {
  grid = Array(16).fill(0);
  score = 0;
  scoreEl.textContent = score;
  addTile(); addTile();
  draw();
}

function addTile() {
  const empty = grid.map((v,i)=>v===0?i:null).filter(v=>v!==null);
  if (!empty.length) return;
  const i = empty[Math.floor(Math.random()*empty.length)];
  grid[i] = Math.random() < 0.9 ? 2 : 4;
}

function draw() {
  board.innerHTML = "";
  grid.forEach(v => {
    const d = document.createElement("div");
    d.className = "cell" + (v ? " n"+v : "");
    d.textContent = v || "";
    board.appendChild(d);
  });
}

function slide(row) {
  row = row.filter(v=>v);
  for (let i=0;i<row.length-1;i++) {
    if (row[i] === row[i+1]) {
      row[i] *= 2;
      score += row[i];
      row[i+1] = 0;
    }
  }
  return row.filter(v=>v).concat(Array(4).fill(0));
}

function rotate(times) {
  for (;times>0;times--) {
    grid = grid.map((_,i)=>grid[12+(i%4)-4*Math.floor(i/4)]);
  }
}

function move(dir) {
  const old = grid.join();
  rotate(dir);
  for (let r=0;r<4;r++) {
    const row = slide(grid.slice(r*4,r*4+4));
    grid.splice(r*4,4,...row);
  }
  rotate((4-dir)%4);

  if (grid.join() !== old) {
    addTile();
    draw();
    scoreEl.textContent = score;
    if (score > high) {
      high = score;
      localStorage.setItem("2048high", high);
      highEl.textContent = high;
    }
  }
}

/* Keyboard */
document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") move(0);
  if (e.key === "ArrowUp") move(1);
  if (e.key === "ArrowRight") move(2);
  if (e.key === "ArrowDown") move(3);
});

/* Mobile swipe */
let startX, startY;
board.addEventListener("touchstart", e => {
  const t = e.touches[0];
  startX = t.clientX;
  startY = t.clientY;
});

board.addEventListener("touchend", e => {
  const t = e.changedTouches[0];
  const dx = t.clientX - startX;
  const dy = t.clientY - startY;

  if (Math.abs(dx) > Math.abs(dy)) {
    if (dx > 30) move(2);
    if (dx < -30) move(0);
  } else {
    if (dy > 30) move(3);
    if (dy < -30) move(1);
  }
});

resetGame();
</script>

</body>
</html>
